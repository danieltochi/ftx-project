<!DOCTYPE html>
<html>
    <head>
        
    </head>
    <body>
        
        <h1>Login</h1>
        
            <!-- <div class="box">
                <p>Email</p>
                <div><input type="text" id="email" autocomplete="on" placeholder="123@gmail.com" required></div>
            </div>
            <div class="box">
                <p>Password</p>
                <div> <input type="password" name="password" placeholder="enter password" required ></div> 
            </div> 
            
            <input type="button" class="loginBtn" id="login" value="Login">
        
            <p class="text">Don't have an account? <a href="#">Signup</a></p> -->
            <form>
                <input type="text" id="email" name="email" placeholder="input Email" required><br>
                <input type="password" id="password" name="password" placeholder="input Password" required><br>
                <input type="button" id="login" name="login" value="login">
            </form>
        
        
       
<script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.9.1/firebase-app.js";
    import { getDatabase, set, ref, update } from "https://www.gstatic.com/firebasejs/9.9.1/firebase-database.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword  } from "https://www.gstatic.com/firebasejs/9.9.1/firebase-auth.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries
  
    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyCScyriOOhq0g9-zceXRAx4oOo8x8bOzgk",
      authDomain: "flx-trade.firebaseapp.com",
      databaseURL: "https://flx-trade-default-rtdb.firebaseio.com",
      projectId: "flx-trade",
      storageBucket: "flx-trade.appspot.com",
      messagingSenderId: "662515131015",
      appId: "1:662515131015:web:ffdaaebaf89889b01c8e22"
    };
  
    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const database = getDatabase(app);
    const auth = getAuth();


    signin.addEventListener('click',(e) => {

        var fname = document.getElementById('fname').value;
        var lname = document.getElementById('lname').value;
        var email = document.getElementById('email').value;
        var password = document.getElementById('password').value;
        
       

        createUserWithEmailAndPassword(auth, email, password)
.then((userCredential) => {
// Signed in 
const user = userCredential.user;

set(ref(database, 'users/' + user.uid),{
    fname: fname,
    lname: lname,
    email: email,
    password: password
})

alert('user created!');
// ...
})
.catch((error) => {
const errorCode = error.code;
const errorMessage = error.message;

alert(errorMessage);
// ..
});

    });

    login.addEventListener('click', (e)=>{
        var email = document.getElementById('email').value;
        var password = document.getElementById('password').value;

        signInWithEmailAndPassword(auth, email, password)
  .then((userCredential) => {
    // Signed in 
    const user = userCredential.user;

    const dt = new Date();
    update(ref(database, 'users/' + user.uid),{
   last_login: dt,
})

alert('User Loged in!');
    // ...
  })
  .catch((error) => {
    const errorCode = error.code;
    const errorMessage = error.message;

    alert(errorMessage);
  });
    });
  </script>
</body>
</html>
